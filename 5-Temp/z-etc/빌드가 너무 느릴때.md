---
date: 2024-05-28 22:19:08
updatedAt: 2024-05-28 22:19:14
---
리모트 빌드 머신/ci 머신 너무 느려서
로컬에서 돌리는걸로 퉁치는데도 많긴해요
근데 로컬에서 돌리는걸로 퉁치는 이유가 여러가지인데
DinD가 안되어서 로컬로 퉁치거나
통합 테스트 환경을 ci 머신에 구축할 수 없어서  라던가
느려서라던가 
생각보다 많음
저는 피드백속도가 주요하다고 보는데
테스트 돌려놓고 라면 끓여도 될 정도로 느리다던가..
그런 관점이면 ci 머신 스펙을 엄청 올리고 스프링 그래들 플젝 기준으로 각 모듈에 대한 테스트를 독립적으로 다 다른 프로세스로 돌리는 방법도 있져
프로세스 한개로 돌려서 느린거라 모듈 잘 쪼개고 모듈 100개를 쓰레드 100개로 돌리고 각각 피드백 수집해서 집계하는 방식도 있어요
그럼 이제 각각 쪼개서 돌리고 쪼개서 돌린 테스트를 집계하는 워커가 필요하죠
그래서 테스트마다 grade 두고 일반 PR ci 단계에선 낮은 grade만 돌리고 베타 나갈땐 그 위 grade 프로덕션 나갈땐 그 위 grade 이런식으로 하면서 백그라운드로는 상시 전체 ci 돌리는 곳도 있구요
저흰 그냥 각 ci 마다 전체 테스트 다 돌리긴 합니다. 아직 안느려서 ㅋㅋ
ci 머신은 가성비 최고는 온프렘으로 워크스테이션 사서 하이퍼 바이저 가상화 올린 뒤에 거기서 갈구는게.. 가장 저렴합니다
한 60만원만 투자해도 평생 쓸듯..

#wait-to-update 